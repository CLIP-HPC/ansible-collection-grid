##############################################################################
#
# lcmaps.db (voms-mapfile and grid-mapfile authorization with banning)
#
##############################################################################

gridmapfile = "lcmaps_localaccount.mod"
              "-gridmap /etc/grid-security/grid-mapfile"
banfile = "lcmaps_ban_dn.mod"
          "-banmapfile /etc/grid-security/ban-mapfile"
banvomsfile = "lcmaps_ban_fqan.mod"
              "-banmapfile /etc/grid-security/ban-voms-mapfile"

vomslocalgroup = "lcmaps_voms_localgroup.mod  -groupmapfile /etc/grid-security/groupmapfile -mapmin 0"

vomspoolaccount = "lcmaps_voms_poolaccount.mod"
              "-gridmap /etc/grid-security/voms-mapfile"
              "-gridmapdir /etc/grid-security/gridmapdir"
vomslocalaccount = "lcmaps_voms_localaccount.mod"
              "-gridmap /etc/grid-security/voms-mapfile"

verifyproxynokey = "lcmaps_verify_proxy.mod"
                   "--allow-limited-proxy"
                   "--discard_private_key_absence"
                   " -certdir /etc/grid-security/certificates"
good        = "lcmaps_dummy_good.mod"
bad         = "lcmaps_dummy_bad.mod"

authorize_only:

verifyproxynokey -> banfile
banfile -> banvomsfile | bad
banvomsfile -> gridmapfile | bad
gridmapfile -> good | vomslocalgroup
vomslocalgroup -> vomspoolaccount
vomspoolaccount -> good | vomslocalaccount
vomslocalaccount -> good | bad
